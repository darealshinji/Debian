#!/bin/sh

version=@VERSION@
confdir=".GrapplingHook"
backupfile="GrapplingHook_config_backup.tar.bz2"

help() {
cat << EOF
Grappling Hook v$version
Copyright (c) 2009 Christian Teister

usage: grapplinghook [<option>|--<option>|-<option>]
       grapplinghook -h|-v

options:
  help, -h         print this message
  version, -v      print game version
  reset            delete your settings and progress
  backup           create a backup of your settings and progress

EOF
}

case x"${1}" in
    xhelp|x--help|x-help|x-h)
        help
        exit 0
        ;;
    xversion|x--version|x-version|x-v)
        echo $version
        exit 0
        ;;
    xreset|x--reset|x-reset)
        read -p "Do you really want to reset your progress and delete your settings? [y/N] " yesno
        case $yesno in
            Y|y) rm -rf "$HOME/$confdir"; echo "Done."; exit 0;;
            N|n|*) exit 0 ;;
        esac
        ;;
    xbackup|x--backup|x-backup)
        if [ ! -d "$HOME/$confdir" ] ; then
            echo "No local game files to backup!"
            exit 0
        fi
        if [ -f "$HOME/$backupfile" ] ; then
            echo "Backup already exists: $HOME/$backupfile"
            exit 0
        fi
        if [ -d "$HOME/$confdir" ] && [ ! -f "$HOME/$backupfile" ] ; then
            cd "$HOME"
            tar -cjf "$backupfile" "$confdir"
            echo "Backup created: $HOME/$backupfile"
            exit 0
        fi
        ;;
esac

cd /usr/share/games/grapplinghook && ./start.sh

