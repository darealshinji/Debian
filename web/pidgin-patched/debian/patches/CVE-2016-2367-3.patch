# HG changeset patch
# User Andrew Victor <andrew.victor@mxit.com>
# Date 1464975625 18000
# Branch release-2.x.y
# Node ID 648f667a679cf13ba957e6481edafa7e210faaf3
# Parent  1c5197a66760396a28de87d566e0eb0d986175ea
Add a check to make sure the file can have a chunk

diff --git a/libpurple/protocols/mxit/chunk.c b/libpurple/protocols/mxit/chunk.c
--- a/libpurple/protocols/mxit/chunk.c
+++ b/libpurple/protocols/mxit/chunk.c
@@ -507,6 +507,10 @@
 
 	memset( getfile, 0, sizeof( struct getfile_chunk ) );
 
+	/* ensure that the chunk size is atleast the minimum size for a "get file" chunk */
+	if ( datalen < 20 )
+		return FALSE;
+
 	/* id [8 bytes] */
 	pos += get_data( &chunkdata[pos], getfile->fileid, 8 );
 
