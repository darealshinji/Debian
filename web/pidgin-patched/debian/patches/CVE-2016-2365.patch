Backport of:

# HG changeset patch
# User Andrew Victor <andrew.victor@mxit.com>
# Date 1464897231 18000
# Branch release-2.x.y
# Node ID 1c4acc6977a8686ad980e5b820327c9c47dbeaca
# Parent  5e5e84e8a79890e580158ac2eae073d7394e93b7
Fix TALOS-CAN-0133

Index: pidgin-2.10.12/libpurple/protocols/mxit/formcmds.c
===================================================================
--- pidgin-2.10.12.orig/libpurple/protocols/mxit/formcmds.c	2016-07-12 08:14:22.406751366 -0400
+++ pidgin-2.10.12/libpurple/protocols/mxit/formcmds.c	2016-07-12 08:14:22.402751319 -0400
@@ -395,6 +395,9 @@
 	/* validator */
 	validator = g_hash_table_lookup(hash, "v");
 
+	if (!name || !validator)
+		return;
+
 	/* image data */
 	tmp = g_hash_table_lookup(hash, "dat");
 	if (tmp) {
@@ -430,13 +433,13 @@
 	}
 
 	tmp = g_hash_table_lookup(hash, "fw");
-	width = atoi(tmp);
+	width = (tmp ? atoi(tmp) : 0);
 
 	tmp = g_hash_table_lookup(hash, "fh");
-	height = atoi(tmp);
+	height = (tmp ? atoi(tmp) : 0);
 
 	tmp = g_hash_table_lookup(hash, "layer");
-	layer = atoi(tmp);
+	layer = (tmp ? atoi(tmp) : 0);
 
 	purple_debug_info(MXIT_PLUGIN_ID, "ImageStrip %s from %s: [w=%i h=%i l=%i validator=%s]\n", name, from, width, height, layer, validator);
 }
@@ -525,21 +528,26 @@
 
 	/* table name */
 	name = g_hash_table_lookup(hash, "nm");
+	if (!name)
+		return;
 
 	/* number of columns */
 	tmp = g_hash_table_lookup(hash, "col");
-	nr_columns = atoi(tmp);
+	nr_columns = (tmp ? atoi(tmp) : 0);
 
 	/* number of rows */
 	tmp = g_hash_table_lookup(hash, "row");
-	nr_rows = atoi(tmp);
+	nr_rows = (tmp ? atoi(tmp) : 0);
 
 	/* mode */
 	tmp = g_hash_table_lookup(hash, "mode");
-	mode = atoi(tmp);
+	mode = (tmp ? atoi(tmp) : 0);
 
 	/* table data */
 	tmp = g_hash_table_lookup(hash, "d");
+	if (!tmp)
+		tmp = "";
+
 	coldata = g_strsplit(tmp, "~", 0);			/* split into entries for each row & column */
 
 	if (g_strv_length(coldata) != (nr_rows * nr_columns)) {
