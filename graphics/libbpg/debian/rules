#!/usr/bin/make -f

LDFLAGS += -L$(CURDIR)/libpng16/.libs -Wl,-z,defs


%:
	dh $@ --parallel

override_dh_auto_clean:
	dh_auto_clean -Dlibpng16
	dh_auto_clean

override_dh_auto_configure:
	dh_auto_configure -Dlibpng16 -- --enable-static=yes --enable-shared=no

override_dh_auto_build:
	dh_auto_build -Dlibpng16
	dh_auto_build

override_dh_installdocs:
	dh_installdocs -A doc/bpg_spec.txt README

override_dh_auto_install:
	$(MAKE) -C libpng16 install DESTDIR=$(CURDIR)/debian/tmp
	install -m644 libbpg.a $(CURDIR)/debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)

override_dh_install:
	dh_install
	mkdir -p debian/libbpg-dev/usr/lib/$(DEB_HOST_MULTIARCH)/pkgconfig
	sed 's|@DEB_HOST_MULTIARCH@|$(DEB_HOST_MULTIARCH)|;' \
		debian/libbpg.pc.in > debian/libbpg-dev/usr/lib/$(DEB_HOST_MULTIARCH)/pkgconfig/libbpg.pc

override_dh_installchangelogs:
	dh_installchangelogs -A ChangeLog

override_dh_compress:
	dh_compress -X.bpg

